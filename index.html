<!DOCTYPE html>
<html>
<head>
	<title>Tic Tac Toe Vs AI Hard</title>
	<link rel="stylesheet" type="text/css" href="main.css">
	<!-- jQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>


	<script type="text/javascript">
	
		var turn = 0;
		var winningCombinations;
		var painted;
		var content;
		var isWinner = false;
		var randomNumber;


		$(document).ready(function(){
		    painted = new Array();
		    content = new Array();
		    winningCombinations = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];

		// Create board
			for (var i = 0; i < 9; i++) {
				$('#board').append('<div class="box" id="box'+ i +'"></div>');
			}

		// create arrays with empty values
			function createArrays() {
			    for(var l = 0; l <= 8; l++){
				    painted[l] = false;
				    content[l]='';
			    }
			}
			createArrays();

		// when box is clicked
			$('.box').click(function(event) {
				var boxPosition = $(".box").index(this);
				// alert("That was div index #" + boxPosition);

				if(isWinner==false){
					if(turn < 9) {
						boxClicked(boxPosition);
					}
				}
			});

			$("#startover").click(function() {
				isWinner = false;
				turn = 0;
				createArrays();
				$('.box').removeClass('red');
				$('.box').removeClass('blue');
			});
		});




		function boxClicked(boxNumber) {
		    theBox = "box"+boxNumber;


			if (painted[boxNumber] == false) { // this condition tell us if the box is empty then...
				turn++;

				painted[boxNumber] = true;
        		content[boxNumber] = 'X';
        		$('#' + theBox).addClass("red");

				checkForWinners("X");
				if(isWinner==false){

					if(turn==9) {
						alert("The Game is over");
					}
					else {
						hardAIThinking();
					}
				}

			}
			else {
				alert("That Space is already filled");
			}
		}

		function hardAIThinking() {

// Need to figure out a way to loop throught all the winningCombinations, checking for close wins.
// An alternative would be to first figure out the computer to try and win. possibly have computer have it's own possible winns array and try to finish one 


			for (var b = 0; b < winningCombinations.length; b++) {
				var possibleblocks = content[winningCombinations[b][0]] == "X" && content[winningCombinations[b][1]] == "X";
				console.log(possibleblocks);
				if (possibleblocks) {
					var blockHere = winningCombinations[b][2];
				}
			}

			if (possibleblocks) {
				if (painted[blockHere] == false) {
					aiTurn(blockHere);
				}
				else {
					randomNumber = Math.floor(Math.random() * 8);
					aiTurn(randomNumber)
				}
			}
			// else if (content[winningCombinations[1][0]] == "X" && content[winningCombinations[1][2]] == "X") {
			// 	if (painted[winningCombinations[1][1]] == false) {
			// 		aiTurn(winningCombinations[1][1]);
			// 	}
			// 	else {
			// 		randomNumber = Math.floor(Math.random() * 8);
			// 		aiTurn(randomNumber)
			// 	}
			// }
			// else if (content[winningCombinations[1][1]] == "X" && content[winningCombinations[1][2]] == "X") {
			// 	if (painted[winningCombinations[1][0]] == false) {
			// 		aiTurn(winningCombinations[1][0]);
			// 	}
			// 	else {
			// 		randomNumber = Math.floor(Math.random() * 8);
			// 		aiTurn(randomNumber)
			// 	}
			// }
			else {
				// random number between 0 and 8
				randomNumber = Math.floor(Math.random() * 8);

				aiTurn(randomNumber)
			}
			
		}

		function aiTurn(compChosenNumber) {
			console.log("randomNumber "+ randomNumber);

			if (painted[compChosenNumber] == false) { // this condition tell us if the box is empty then...
				turn++;
				
				content[compChosenNumber] = "O";
				painted[compChosenNumber] = true;
				$('#box' + compChosenNumber).addClass("blue");

				checkForWinners("O");
			}
			else {
				// alert("comp choose wrong");
				randomNumber = Math.floor(Math.random() * 8);
				aiTurn(randomNumber);
			}
		}


		function checkForWinners(symbol) {
		    for(var a = 0; a < winningCombinations.length; a++) {
			    if(content[winningCombinations[a][0]]==symbol && content[winningCombinations[a][1]]== symbol && content[winningCombinations[a][2]]==symbol) {
			        alert(symbol+ " WON!");
			        isWinner = true;
			    }
		    }
		}

		// for Impossible AI, use similar logic to checkForWinners function, If 2 of the arguments are true than take the 3rd. 
		// but as a computer you also want to try to win so look for possible wins.

	</script>
</head>
<body>
	<h1>Tic Tac Toe</h1>
	<div id="board"></div>
	<button id="startover">Start Over</button>
</body>
</html>